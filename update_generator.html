<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenClash 更新配置生成器</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4A90E2;
            --secondary-color: #F5F7FA;
            --accent-color: #2C5282;
            --text-color: #2C3E50;
            --border-radius: 12px;
        }

        body {
            background-color: var(--secondary-color);
            color: var(--text-color);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            padding: 30px 0;
        }

        .container {
            max-width: 1000px;
        }

        .card {
            border: none;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 24px;
            transition: transform 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0 !important;
            padding: 15px 20px;
        }

        .platform-card {
            border-left: 4px solid var(--primary-color);
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .form-control {
            border-radius: 8px;
            border: 1px solid #E2E8F0;
            padding: 10px 15px;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
        }

        .btn {
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border: none;
        }

        .btn-primary:hover {
            background-color: var(--accent-color);
            transform: translateY(-1px);
        }

        #jsonOutput {
            background-color: #2D3748;
            color: #E2E8F0;
            padding: 20px;
            border-radius: var(--border-radius);
            font-family: 'Monaco', monospace;
        }

        .back-btn {
            position: fixed;
            left: 20px;
            top: 20px;
            z-index: 1000;
        }

        .platform-icon {
            font-size: 1.2em;
            margin-right: 8px;
            color: var(--primary-color);
        }
    </style>
</head>
<body>
    <a href="index.html" class="btn btn-outline-primary back-btn">
        <i class="fas fa-arrow-left me-2"></i>返回
    </a>

    <div class="container">
        <h1 class="text-center mb-4">OpenClash 更新配置生成器</h1>
        
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <form id="updateForm">
                    <!-- 通用配置 -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">通用配置</h5>
                        </div>
                        <div class="card-body">
                            <div class="form-group mb-3">
                                <label class="form-label">版本号</label>
                                <input type="text" class="form-control" name="version" placeholder="例如: 1.0.0" required>
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-label">更新内容</label>
                                <textarea class="form-control" name="body" rows="3" placeholder="输入通用更新内容"></textarea>
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-label">下载链接</label>
                                <input type="text" class="form-control" name="download_url" placeholder="输入通用下载链接">
                            </div>
                        </div>
                    </div>

                    <!-- 平台特定配置 -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">平台特定配置</h5>
                        </div>
                        <div class="card-body">
                            <!-- Windows -->
                            <div class="platform-card">
                                <h6 class="mb-3">
                                    <i class="fab fa-windows platform-icon"></i>Windows 配置
                                </h6>
                                <div class="form-group mb-3">
                                    <label class="form-label">版本号</label>
                                    <input type="text" class="form-control" name="windows_version" placeholder="Windows版本号">
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">更新内容</label>
                                    <textarea class="form-control" name="windows_body" rows="2" placeholder="Windows更新内容"></textarea>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">下载链接</label>
                                    <input type="text" class="form-control" name="windows_download_url" placeholder="Windows下载链接">
                                </div>
                            </div>

                            <!-- macOS -->
                            <div class="platform-card">
                                <h6 class="mb-3">
                                    <i class="fab fa-apple platform-icon"></i>macOS 配置
                                </h6>
                                <div class="form-group mb-3">
                                    <label class="form-label">版本号</label>
                                    <input type="text" class="form-control" name="macos_version" placeholder="macOS版本号">
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">更新内容</label>
                                    <textarea class="form-control" name="macos_body" rows="2" placeholder="macOS更新内容"></textarea>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">下载链接</label>
                                    <input type="text" class="form-control" name="macos_download_url" placeholder="macOS下载链接">
                                </div>
                            </div>

                            <!-- Android -->
                            <div class="platform-card">
                                <h6 class="mb-3">
                                    <i class="fab fa-android platform-icon"></i>Android 配置
                                </h6>
                                <div class="form-group mb-3">
                                    <label class="form-label">版本号</label>
                                    <input type="text" class="form-control" name="android_version" placeholder="Android版本号">
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">更新内容</label>
                                    <textarea class="form-control" name="android_body" rows="2" placeholder="Android更新内容"></textarea>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">下载链接</label>
                                    <input type="text" class="form-control" name="android_download_url" placeholder="Android下载链接">
                                </div>
                            </div>

                            <!-- Linux -->
                            <div class="platform-card">
                                <h6 class="mb-3">
                                    <i class="fab fa-linux platform-icon"></i>Linux 配置
                                </h6>
                                <div class="form-group mb-3">
                                    <label class="form-label">版本号</label>
                                    <input type="text" class="form-control" name="linux_version" placeholder="Linux版本号">
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">更新内容</label>
                                    <textarea class="form-control" name="linux_body" rows="2" placeholder="Linux更新内容"></textarea>
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label">下载链接</label>
                                    <input type="text" class="form-control" name="linux_download_url" placeholder="Linux下载链接">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">生成配置</button>
                    </div>
                </form>

                <!-- JSON输出 -->
                <div class="card mt-4">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">配置预览</h5>
                        <div>
                            <button class="btn btn-sm btn-light me-2" onclick="copyJson()">复制</button>
                            <button class="btn btn-sm btn-success" onclick="downloadJson()">下载</button>
                        </div>
                    </div>
                    <div class="card-body">
                        <pre id="jsonOutput"></pre>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copyJson() {
            const jsonText = document.getElementById('jsonOutput').textContent;
            navigator.clipboard.writeText(jsonText).then(() => {
                alert('配置已复制到剪贴板！');
            });
        }

        function downloadJson() {
            try {
                const jsonText = document.getElementById('jsonOutput').textContent;
                if (!jsonText || jsonText.trim() === '') {
                    alert('请先生成配置内容');
                    return;
                }
                
                // 创建 Blob 对象
                const blob = new Blob([jsonText], { type: 'application/json' });
                
                // 创建下载链接
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'update.json';
                
                // 添加到文档并触发点击
                document.body.appendChild(a);
                
                // 使用 setTimeout 确保下载触发
                setTimeout(() => {
                    a.click();
                    // 清理
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 100);
            } catch (error) {
                console.error('下载配置时出错:', error);
                alert('下载配置时出错: ' + error.message);
            }
        }

        document.getElementById('updateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const config = {
                version: formData.get('version'),
                body: formData.get('body'),
                download_url: formData.get('download_url'),
                platforms: {
                    windows: {
                        version: formData.get('windows_version') || formData.get('version'),
                        body: formData.get('windows_body') || formData.get('body'),
                        download_url: formData.get('windows_download_url') || formData.get('download_url')
                    },
                    macos: {
                        version: formData.get('macos_version') || formData.get('version'),
                        body: formData.get('macos_body') || formData.get('body'),
                        download_url: formData.get('macos_download_url') || formData.get('download_url')
                    },
                    android: {
                        version: formData.get('android_version') || formData.get('version'),
                        body: formData.get('android_body') || formData.get('body'),
                        download_url: formData.get('android_download_url') || formData.get('download_url')
                    },
                    linux: {
                        version: formData.get('linux_version') || formData.get('version'),
                        body: formData.get('linux_body') || formData.get('body'),
                        download_url: formData.get('linux_download_url') || formData.get('download_url')
                    }
                }
            };

            document.getElementById('jsonOutput').textContent = JSON.stringify(config, null, 2);
        });
    </script>
</body>
</html>